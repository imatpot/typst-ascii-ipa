// https://help.keyman.com/keyboard/sil_ipa/1.8.6/sil_ipa
// https://en.wikipedia.org/wiki/Comparison_of_ASCII_encodings_of_the_International_Phonetic_Alphabet

#let sil-unicode = (
  ("!", "ǃ"),
  ("!<", "ǀ"),
  ("!=", "ǂ"),
  ("!>", "ǁ"),
  ("#!", "ꜞ"),
  ("##!", "ꜟ"),
  ("#&", "͡"),
  ("#0", "˩"),
  ("#04", "˩˥"),
  ("#1", "˨"),
  ("#12", "˨˧"),
  ("#141", "˨˥˨"),
  ("#2", "˧"),
  ("#24", "˧˥"),
  ("#3", "˦"),
  ("#4", "˥"),
  ("#40", "˥˩"),
  ("#<", "ꜜ"),
  ("#<<", "↘"),
  ("#=", "͜"),
  ("#>", "ꜛ"),
  ("#>>", "↗"),
  ("$", "̩"),
  ("$$", "̯"),
  ("$$$", "̰"),
  ("$$$$", "̢"),
  ("%", "̥"),
  ("%%", "̬"),
  ("%%%", "̤"),
  ("%%%%", "̡"),
  ("*", "̈"),
  ("**", "̽"),
  ("***", "̆"),
  ("****", "̇"),
  ("*****", "̐"),
  ("+", "̟"),
  ("++", "̝"),
  ("+++", "̘"),
  ("++++", "̹"),
  (".", "."),
  (".<", "|"),
  (".=", "‖"),
  (":", "ː"),
  ("::", "ˑ"),
  (":::", "ːː"),
  ("=>", "→"),
  ("?<", "ʕ"),
  ("?=", "ʔ"),
  ("@", "̊"),
  ("@&", "͜"),
  ("@0", "̏"),
  ("@1", "̀"),
  ("@12", "᷅"),
  ("@13", "̌"),
  ("@131", "᷈"),
  ("@2", "̄"),
  ("@21", "᷆"),
  ("@23", "᷄"),
  ("@3", "́"),
  ("@31", "̂"),
  ("@313", "᷉"),
  ("@32", "᷇"),
  ("@4", "̋"),
  ("@@", "̍"),
  ("B=", "ʙ"),
  ("E<", "œ"),
  ("E=", "ɘ"),
  ("E>", "ɶ"),
  ("G=", "ɢ"),
  ("G>", "ʛ"),
  ("H=", "ʜ"),
  ("H>", "ɧ"),
  ("I=", "ɨ"),
  ("L<", "ʎ"),
  ("L=", "ʟ"),
  ("L>", "ɺ"),
  ("N=", "ɴ"),
  ("O<", "ɞ"),
  ("O=", "ɵ"),
  ("O>", "ɤ"),
  ("Q<", "ʢ"),
  ("Q=", "ʡ"),
  ("R<", "ɻ"),
  ("R=", "ʀ"),
  ("R>", "ʁ"),
  ("U=", "ʉ"),
  ("[[", "ʽ"),
  ("[[[", "˞"),
  ("]]", "ʼ"),
  ("]]]", "̚"),
  ("]]]]", "ʻ"),
  ("_", "̠"),
  ("__", "̞"),
  ("___", "̙"),
  ("____", "̜"),
  ("_____", "̧"),
  ("a<", "æ"),
  ("a=", "ɑ"),
  ("a>", "ɐ"),
  ("b", "b"),
  ("b=", "β"),
  ("b>", "ɓ"),
  ("c", "c"),
  ("c<", "ɕ"),
  ("c=", "ç"),
  ("d", "d"),
  ("d<", "ɖ"),
  ("d=", "ð"),
  ("d>", "ɗ"),
  ("e", "e"),
  ("e<", "ɛ"),
  ("e=", "ə"),
  ("e>", "ɜ"),
  ("f", "f"),
  ("f=", "ɸ"),
  ("g<", "ɡ"),
  ("g=", "ɣ"),
  ("g>", "ɠ"),
  ("h", "h"),
  ("h<", "ɦ"),
  ("h=", "ɥ"),
  ("h>", "ħ"),
  ("i", "i"),
  ("i=", "ɪ"),
  ("j", "j"),
  ("j<", "ʝ"),
  ("j=", "ɟ"),
  ("j>", "ʄ"),
  ("k", "k"),
  ("l", "l"),
  ("l<", "ɭ"),
  ("l=", "ɬ"),
  ("l>", "ɮ"),
  ("l~~", "ɫ"),
  ("m", "m"),
  ("m>", "ɱ"),
  ("n", "n"),
  ("n<", "ɳ"),
  ("n=", "ɲ"),
  ("n>", "ŋ"),
  ("o", "o"),
  ("o<", "ɔ"),
  ("o=", "ɒ"),
  ("o>", "ø"),
  ("p", "p"),
  ("p=", "ʘ"),
  ("q", "q"),
  ("r", "r"),
  ("r<", "ɽ"),
  ("r=", "ɹ"),
  ("r>", "ɾ"),
  ("s", "s"),
  ("s<", "ʂ"),
  ("s=", "ʃ"),
  ("s>", "σ"),
  ("t", "t"),
  ("t<", "ʈ"),
  ("t=", "θ"),
  ("u", "u"),
  ("u<", "ʊ"),
  ("u=", "ɯ"),
  ("u>", "ʌ"),
  ("v", "v"),
  ("v<", "ⱱ"),
  ("v=", "ʋ"),
  ("w", "w"),
  ("w=", "ʍ"),
  ("w>", "ɰ"),
  ("x", "x"),
  ("x=", "χ"),
  ("y", "y"),
  ("y<", "ɥ"),
  ("y=", "ʏ"),
  ("z", "z"),
  ("z<", "ʐ"),
  ("z=", "ʒ"),
  ("z>", "ʑ"),
  ("{", "̪"),
  ("{{", "̺"),
  ("{{{", "̻"),
  ("{{{{", "̼"),
  ("{{{{{", "̣"),
  ("}", "ˈ"),
  ("}}", "ˌ"),
  ("}}}", "͈"),
  ("}}}}", "᷂"),
  ("~", "̃"),
  ("~~", "̴"),
)

#let superscripts = (
  ("-", "⁻"),
  ("0", "⁰"),
  ("1", "¹"),
  ("2", "²"),
  ("3", "³"),
  ("4", "⁴"),
  ("5", "⁵"),
  ("6", "⁶"),
  ("7", "⁷"),
  ("8", "⁸"),
  ("9", "⁹"),
  ("a", "ᵃ"),
  ("b", "ᵇ"),
  ("c", "ᶜ"),
  ("d", "ᵈ"),
  ("e", "ᵉ"),
  ("f", "ᶠ"),
  ("g", "ᵍ"),
  ("h", "ʰ"),
  ("i", "ⁱ"),
  ("j", "ʲ"),
  ("k", "ᵏ"),
  ("l", "ˡ"),
  ("m", "ᵐ"),
  ("n", "ⁿ"),
  ("o", "ᵒ"),
  ("p", "ᵖ"),
  ("q", "𐞥"),
  ("r", "ʳ"),
  ("s", "ˢ"),
  ("t", "ᵗ"),
  ("u", "ᵘ"),
  ("v", "ᵛ"),
  ("w", "ʷ"),
  ("x", "ˣ"),
  ("y", "ʸ"),
  ("z", "ᶻ"),
  ("¡", "ꜞ"),
  ("æ", "𐞃"),
  ("ç", "ᶜ̧"),
  ("ð", "ᶞ"),
  ("ø", "𐞢"),
  ("ħ", "𐞕"),
  ("ŋ", "ᵑ"),
  ("œ", "ꟹ"),
  ("ǀ", "𐞶"),
  ("ǁ", "𐞷"),
  ("ǂ", "𐞸"),
  ("ǃ", "ꜝ"),
  ("ɐ", "ᵄ"),
  ("ɑ", "ᵅ"),
  ("ɒ", "ᶛ"),
  ("ɓ", "𐞅"),
  ("ɔ", "ᵓ"),
  ("ɖ", "𐞋"),
  ("ɗ", "𐞌"),
  ("ɘ", "𐞎"),
  ("ə", "ᵊ"),
  ("ɛ", "ᵋ"),
  ("ɜ", "ᶟ"),
  ("ɞ", "𐞏"),
  ("ɟ", "ᶡ"),
  ("ɠ", "𐞓"),
  ("ɢ", "𐞒"),
  ("ɣ", "ˠ"),
  ("ɤ", "𐞑"),
  ("ɦ", "ʱ"),
  ("ɨ", "ᶤ"),
  ("ɪ", "ᶦ"),
  ("ɬ", "𐞛"),
  ("ɭ", "ᶩ"),
  ("ɮ", "𐞞"),
  ("ɯ", "ᵚ"),
  ("ɰ", "ᶭ"),
  ("ɱ", "ᶬ"),
  ("ɲ", "ᶮ"),
  ("ɳ", "ᶯ"),
  ("ɴ", "ᶰ"),
  ("ɵ", "ᶱ"),
  ("ɶ", "𐞣"),
  ("ɸ", "ᶲ"),
  ("ɹ", "ʴ"),
  ("ɺ", "𐞦"),
  ("ɻ", "ʵ"),
  ("ɽ", "𐞨"),
  ("ɾ", "𐞩"),
  ("ʀ", "𐞪"),
  ("ʁ", "ʶ"),
  ("ʂ", "ᶳ"),
  ("ʃ", "ᶴ"),
  ("ʄ", "𐞘"),
  ("ʈ", "𐞯"),
  ("ʉ", "ᶶ"),
  ("ʊ", "ᶷ"),
  ("ʋ", "ᶹ"),
  ("ʌ", "ᶺ"),
  ("ʎ", "𐞠"),
  ("ʏ", "𐞲"),
  ("ʐ", "ᶼ"),
  ("ʒ", "ᶾ"),
  ("ʔ", "ˀ"),
  ("ʕ", "ˤ"),
  ("ʘ", "𐞵"),
  ("ʙ", "𐞄"),
  ("ʛ", "𐞔"),
  ("ʜ", "𐞖"),
  ("ʝ", "ᶨ"),
  ("ʟ", "ᶫ"),
  ("ʡ", "𐞳"),
  ("ʢ", "𐞴"),
  ("ʣ", "𐞇"),
  ("ʤ", "𐞊"),
  ("ʦ", "𐞬"),
  ("ʧ", "𐞮"),
  ("ː", "𐞁"),
  ("ˑ", "𐞂"),
  ("β", "ᵝ"),
  ("θ", "ᶿ"),
  ("χ", "ᵡ"),
  ("ᵻ", "ᶧ"),
  ("ᶑ", "𐞍"),
  ("ⱱ", "𐞰"),
  ("ꞎ", "𐞝"),
  ("ꭦ", "𐞈"),
  ("ꭧ", "𐞭"),
  ("𝼄", "𐞜"),
  ("𝼅", "𐞟"),
  ("𝼆", "𐞡"),
  ("𝼈", "𐞧"),
  ("𝼊", "𐞹"),
)

// TODO footnotes of https://help.keyman.com/keyboard/sil_ipa/1.8.6/sil_ipa

#let sil(text, reverse: false) = {
  let (from, to) = if reverse { (1, 0) } else { (0, 1) }

  if reverse {
    for (normal, super) in superscripts {
      text = text.replace(super, normal + "^")
    }
  }

  for pair in sil-unicode {
    text = text.replace(pair.at(from), pair.at(to))
  }

  if not reverse {
    for (normal, super) in superscripts {
      text = text.replace(normal + "^", super)
    }
  }

  return text
}
