// https://help.keyman.com/keyboard/sil_ipa/1.8.6/sil_ipa
// https://en.wikipedia.org/wiki/Comparison_of_ASCII_encodings_of_the_International_Phonetic_Alphabet

#let sil-unicode = (
  ("!", "Çƒ"),
  ("!<", "Ç€"),
  ("!=", "Ç‚"),
  ("!>", "Ç"),
  ("#!", "êœ"),
  ("##!", "êœŸ"),
  ("#&", "Í¡"),
  ("#0", "Ë©"),
  ("#04", "Ë©Ë¥"),
  ("#1", "Ë¨"),
  ("#12", "Ë¨Ë§"),
  ("#141", "Ë¨Ë¥Ë¨"),
  ("#2", "Ë§"),
  ("#24", "Ë§Ë¥"),
  ("#3", "Ë¦"),
  ("#4", "Ë¥"),
  ("#40", "Ë¥Ë©"),
  ("#<", "êœœ"),
  ("#<<", "â†˜"),
  ("#=", "Íœ"),
  ("#>", "êœ›"),
  ("#>>", "â†—"),
  ("$", "Ì©"),
  ("$$", "Ì¯"),
  ("$$$", "Ì°"),
  ("$$$$", "Ì¢"),
  ("%", "Ì¥"),
  ("%%", "Ì¬"),
  ("%%%", "Ì¤"),
  ("%%%%", "Ì¡"),
  ("*", "Ìˆ"),
  ("**", "Ì½"),
  ("***", "Ì†"),
  ("****", "Ì‡"),
  ("*****", "Ì"),
  ("+", "ÌŸ"),
  ("++", "Ì"),
  ("+++", "Ì˜"),
  ("++++", "Ì¹"),
  (".", "."),
  (".<", "|"),
  (".=", "â€–"),
  (":", "Ë"),
  ("::", "Ë‘"),
  (":::", "ËË"),
  ("=>", "â†’"),
  ("?<", "Ê•"),
  ("?=", "Ê”"),
  ("@", "ÌŠ"),
  ("@&", "Íœ"),
  ("@0", "Ì"),
  ("@1", "Ì€"),
  ("@12", "á·…"),
  ("@13", "ÌŒ"),
  ("@131", "á·ˆ"),
  ("@2", "Ì„"),
  ("@21", "á·†"),
  ("@23", "á·„"),
  ("@3", "Ì"),
  ("@31", "Ì‚"),
  ("@313", "á·‰"),
  ("@32", "á·‡"),
  ("@4", "Ì‹"),
  ("@@", "Ì"),
  ("B=", "Ê™"),
  ("E<", "Å“"),
  ("E=", "É˜"),
  ("E>", "É¶"),
  ("G=", "É¢"),
  ("G>", "Ê›"),
  ("H=", "Êœ"),
  ("H>", "É§"),
  ("I=", "É¨"),
  ("L<", "Ê"),
  ("L=", "ÊŸ"),
  ("L>", "Éº"),
  ("N=", "É´"),
  ("O<", "É"),
  ("O=", "Éµ"),
  ("O>", "É¤"),
  ("Q<", "Ê¢"),
  ("Q=", "Ê¡"),
  ("R<", "É»"),
  ("R=", "Ê€"),
  ("R>", "Ê"),
  ("U=", "Ê‰"),
  ("[[", "Ê½"),
  ("[[[", "Ë"),
  ("]]", "Ê¼"),
  ("]]]", "Ìš"),
  ("]]]]", "Ê»"),
  ("_", "Ì "),
  ("__", "Ì"),
  ("___", "Ì™"),
  ("____", "Ìœ"),
  ("_____", "Ì§"),
  ("a<", "Ã¦"),
  ("a=", "É‘"),
  ("a>", "É"),
  ("b", "b"),
  ("b=", "Î²"),
  ("b>", "É“"),
  ("c", "c"),
  ("c<", "É•"),
  ("c=", "Ã§"),
  ("d", "d"),
  ("d<", "É–"),
  ("d=", "Ã°"),
  ("d>", "É—"),
  ("e", "e"),
  ("e<", "É›"),
  ("e=", "É™"),
  ("e>", "Éœ"),
  ("f", "f"),
  ("f=", "É¸"),
  ("g<", "É¡"),
  ("g=", "É£"),
  ("g>", "É "),
  ("h", "h"),
  ("h<", "É¦"),
  ("h=", "É¥"),
  ("h>", "Ä§"),
  ("i", "i"),
  ("i=", "Éª"),
  ("j", "j"),
  ("j<", "Ê"),
  ("j=", "ÉŸ"),
  ("j>", "Ê„"),
  ("k", "k"),
  ("l", "l"),
  ("l<", "É­"),
  ("l=", "É¬"),
  ("l>", "É®"),
  ("l~~", "É«"),
  ("m", "m"),
  ("m>", "É±"),
  ("n", "n"),
  ("n<", "É³"),
  ("n=", "É²"),
  ("n>", "Å‹"),
  ("o", "o"),
  ("o<", "É”"),
  ("o=", "É’"),
  ("o>", "Ã¸"),
  ("p", "p"),
  ("p=", "Ê˜"),
  ("q", "q"),
  ("r", "r"),
  ("r<", "É½"),
  ("r=", "É¹"),
  ("r>", "É¾"),
  ("s", "s"),
  ("s<", "Ê‚"),
  ("s=", "Êƒ"),
  ("s>", "Ïƒ"),
  ("t", "t"),
  ("t<", "Êˆ"),
  ("t=", "Î¸"),
  ("u", "u"),
  ("u<", "ÊŠ"),
  ("u=", "É¯"),
  ("u>", "ÊŒ"),
  ("v", "v"),
  ("v<", "â±±"),
  ("v=", "Ê‹"),
  ("w", "w"),
  ("w=", "Ê"),
  ("w>", "É°"),
  ("x", "x"),
  ("x=", "Ï‡"),
  ("y", "y"),
  ("y<", "É¥"),
  ("y=", "Ê"),
  ("z", "z"),
  ("z<", "Ê"),
  ("z=", "Ê’"),
  ("z>", "Ê‘"),
  ("{", "Ìª"),
  ("{{", "Ìº"),
  ("{{{", "Ì»"),
  ("{{{{", "Ì¼"),
  ("{{{{{", "Ì£"),
  ("}", "Ëˆ"),
  ("}}", "ËŒ"),
  ("}}}", "Íˆ"),
  ("}}}}", "á·‚"),
  ("~", "Ìƒ"),
  ("~~", "Ì´"),
)

#let superscripts = (
  ("-", "â»"),
  ("0", "â°"),
  ("1", "Â¹"),
  ("2", "Â²"),
  ("3", "Â³"),
  ("4", "â´"),
  ("5", "âµ"),
  ("6", "â¶"),
  ("7", "â·"),
  ("8", "â¸"),
  ("9", "â¹"),
  ("a", "áµƒ"),
  ("b", "áµ‡"),
  ("c", "á¶œ"),
  ("d", "áµˆ"),
  ("e", "áµ‰"),
  ("f", "á¶ "),
  ("g", "áµ"),
  ("h", "Ê°"),
  ("i", "â±"),
  ("j", "Ê²"),
  ("k", "áµ"),
  ("l", "Ë¡"),
  ("m", "áµ"),
  ("n", "â¿"),
  ("o", "áµ’"),
  ("p", "áµ–"),
  ("q", "ğ¥"),
  ("r", "Ê³"),
  ("s", "Ë¢"),
  ("t", "áµ—"),
  ("u", "áµ˜"),
  ("v", "áµ›"),
  ("w", "Ê·"),
  ("x", "Ë£"),
  ("y", "Ê¸"),
  ("z", "á¶»"),
  ("Â¡", "êœ"),
  ("Ã¦", "ğƒ"),
  ("Ã§", "á¶œÌ§"),
  ("Ã°", "á¶"),
  ("Ã¸", "ğ¢"),
  ("Ä§", "ğ•"),
  ("Å‹", "áµ‘"),
  ("Å“", "êŸ¹"),
  ("Ç€", "ğ¶"),
  ("Ç", "ğ·"),
  ("Ç‚", "ğ¸"),
  ("Çƒ", "êœ"),
  ("É", "áµ„"),
  ("É‘", "áµ…"),
  ("É’", "á¶›"),
  ("É“", "ğ…"),
  ("É”", "áµ“"),
  ("É–", "ğ‹"),
  ("É—", "ğŒ"),
  ("É˜", "ğ"),
  ("É™", "áµŠ"),
  ("É›", "áµ‹"),
  ("Éœ", "á¶Ÿ"),
  ("É", "ğ"),
  ("ÉŸ", "á¶¡"),
  ("É ", "ğ“"),
  ("É¢", "ğ’"),
  ("É£", "Ë "),
  ("É¤", "ğ‘"),
  ("É¦", "Ê±"),
  ("É¨", "á¶¤"),
  ("Éª", "á¶¦"),
  ("É¬", "ğ›"),
  ("É­", "á¶©"),
  ("É®", "ğ"),
  ("É¯", "áµš"),
  ("É°", "á¶­"),
  ("É±", "á¶¬"),
  ("É²", "á¶®"),
  ("É³", "á¶¯"),
  ("É´", "á¶°"),
  ("Éµ", "á¶±"),
  ("É¶", "ğ£"),
  ("É¸", "á¶²"),
  ("É¹", "Ê´"),
  ("Éº", "ğ¦"),
  ("É»", "Êµ"),
  ("É½", "ğ¨"),
  ("É¾", "ğ©"),
  ("Ê€", "ğª"),
  ("Ê", "Ê¶"),
  ("Ê‚", "á¶³"),
  ("Êƒ", "á¶´"),
  ("Ê„", "ğ˜"),
  ("Êˆ", "ğ¯"),
  ("Ê‰", "á¶¶"),
  ("ÊŠ", "á¶·"),
  ("Ê‹", "á¶¹"),
  ("ÊŒ", "á¶º"),
  ("Ê", "ğ "),
  ("Ê", "ğ²"),
  ("Ê", "á¶¼"),
  ("Ê’", "á¶¾"),
  ("Ê”", "Ë€"),
  ("Ê•", "Ë¤"),
  ("Ê˜", "ğµ"),
  ("Ê™", "ğ„"),
  ("Ê›", "ğ”"),
  ("Êœ", "ğ–"),
  ("Ê", "á¶¨"),
  ("ÊŸ", "á¶«"),
  ("Ê¡", "ğ³"),
  ("Ê¢", "ğ´"),
  ("Ê£", "ğ‡"),
  ("Ê¤", "ğŠ"),
  ("Ê¦", "ğ¬"),
  ("Ê§", "ğ®"),
  ("Ë", "ğ"),
  ("Ë‘", "ğ‚"),
  ("Î²", "áµ"),
  ("Î¸", "á¶¿"),
  ("Ï‡", "áµ¡"),
  ("áµ»", "á¶§"),
  ("á¶‘", "ğ"),
  ("â±±", "ğ°"),
  ("ê", "ğ"),
  ("ê­¦", "ğˆ"),
  ("ê­§", "ğ­"),
  ("ğ¼„", "ğœ"),
  ("ğ¼…", "ğŸ"),
  ("ğ¼†", "ğ¡"),
  ("ğ¼ˆ", "ğ§"),
  ("ğ¼Š", "ğ¹"),
)

// TODO footnotes of https://help.keyman.com/keyboard/sil_ipa/1.8.6/sil_ipa

#let sil(text, reverse: false) = {
  let (from, to) = if reverse { (1, 0) } else { (0, 1) }

  if reverse {
    for (normal, super) in superscripts {
      text = text.replace(super, normal + "^")
    }
  }

  for pair in sil-unicode {
    text = text.replace(pair.at(from), pair.at(to))
  }

  if not reverse {
    for (normal, super) in superscripts {
      text = text.replace(normal + "^", super)
    }
  }

  return text
}
